# Blogify

The Blogify project is a full-stack web-application allowing user to create, update, maintain blogs and share them easily.

## Key features:

- User can sign up and login.
- User can edit and delete account.
- User can write, edit and delete blogs
- Blogs concists of elements like blocks of text, images, lists and so on.
- App theme can be switched

## Technologies

### Client App

- JavaScript – programming language used to create dynamic content for websides
- Vue – modern JavaScript framework for building user interfaces.
- Vite - a local development server.
- TypeScript – language that adds static typing with optional type annotations to JavaScript
- Cypress – tool to automatic testing and debugging web applications.
- Pinia – state managment library for Vue.
- Sass – CSS pre-processor.
- Iconify – icon library for Vue.
- ESLint - static code analysis tool.

### Server App

- Node.js – JavaScript runtime enviroment.
- TypeScript – language that adds static typing with optional type annotations to JavaScript.
- Express – minimal and flexible Node.js web application framework.
- MongoDB – NoSQL database.
- Mongoose – ODM (Object Data Modeling) library for MongoDB.
- JWT - compact and self-contained way to represent information between two parties securely.
- Bcrypt – password-hashing function.
- Zod - TypeScript-first schema declaration and validation library.
- Multer - node.js middleware for handling multipart/form-data.
- ESLint - static code analysis tool.
- Vitest – library for testing

## Enviroment Setup

The project uses Node.js v20.10.0.

### Client app setup:

Run `cd client`, then `npm run i`, next: Create an `.env` file in `/client`, with the following properties:

| Property        | Value                                     |
| --------------- | ----------------------------------------- |
| VITE_CLIENT_URL | Client app url e.g. http://localhost:3000 |
| VITE_SERVER_URL | Server app url e.g. http://localhost:4000 |

Run:
• `npm run preview` for previewing
• `npm run dev` for development
• `npm run build` for production, build folder will be located in `/server/dist/client`
• `npm run test` for testing in Cypress window
• `npm run test-cmd` for testing in cmd

### Server app setup:

- Run `cd server`, then `npm run i`, next:
- Create an `.env` file in `/server/src/config/env`. Name the file `.env.prod`, `.env.dev` or `.env.test` for specific environment. Env variables are validated in `/server/src/config/envVariables.ts` file and should be imported from there.
- For database uri you can go to https://www.mongodb.com and create cluster or install MongoDB compass (recommended for testing on client). Server test are handled in memory with MongoDbMemoryServer.
- JWT key should be secret and can be generated using `node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"`.
- Recommended file saving location is `/static/uploads` for prod or dev env or `/static/.test-env-uploads` for testing.

| Property         | Value                                                          |
| ---------------- | -------------------------------------------------------------- |
| NODE_ENV         | Client Node environment type (PRODUCTION, DEVELOPMENT or TEST) |
| MONGO_URI        | MongoDB uri                                                    |
| TOKEN_SECRET     | JWT secret key                                                 |
| SALT_ROUNDS      | Time to calculate bcrypt hash e.g. 10                          |
| PORT             | Server app port                                                |
| CLIENT_APP_URL   | Client app url e.g. http://localhost:3000                      |
| FILE_UPLOAD_PATH | File saving location                                           |

Run:

- `npm run dev` for development
- `npm run start` for starting the production app
- `npm run build` for creating a production app, build folder with static files will be located in `/server/dist`
- `npm run test` for testing server app
- `npm run test-client` server app mode for testing the client app with server

## File Structure

- client
  - cypress – tests for client app
    - e2e – end-to-end test files
    - fixtures – sample data and files used for testing
    - node_modules
  - src – client source code
    - app – constants, global state, and things to use throughout the project
      - constants
      - hooks – global hooks
      - stores – global stores
      - style – global style and themes
      - utils – functions used throughout the project
    - components – reusable components
    - pages – pages and their associated local features
- server
  - \_\_tests\_\_ - tests for backend app
    - components – tests divided into files
    - logs – logs generated by tests
  - dist – production app
  - node_modules
  - src – backend source code
    - config – constants and env files
    - controllers
    - middlewares
    - models – mongoose models
    - routes
    - utils – repeatedly used functions
  - types – zod schemas and types used by both-apps
  - static – static and user-uploaded files

## Routes

### Client

- / - Home page
- /user/login - Login page
- /user/create - Create user page
- /user/:id - User profile page
- /user/:id/update - Update user page
- /blog/create – Create Blog page
- /blog/:id – Blog page
- /blog/:id/update – Update blog page
- /\* - 404 not found page

### Server

- BLOG /api/blog
  - GET / - Get blogs
  - GET /:id – Get blog
  - POST / - Create blog
  - PATCH /:id – Update blog
  - DELETE /:id – Delete blog
  - POST /:id – Create element
  - PATCH /:blogId/:elementId - Update element
  - DELETE /:blogId/:elementId - Delete element
- USER /api/user
  - GET / - Get users
  - GET /:id – Get user
  - POST / - Create user
  - POST /login – Login
  - PATCH /:id – Update user
  - DELETE /:id – Delete user
- Miscellaneous
  - GET /static/uploads/:filename – Uploaded files
  - GET /static/:filename – Static files
  - GET /heathcheck – Get server state
  - GET /api/reset – Reset server
